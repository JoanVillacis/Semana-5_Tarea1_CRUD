
using _02_CRUD.Controladores;

namespace _02_CRUD.Vistas.Roles
{
    public partial class frm_lista_roles : Form
    {
        private readonly Rol_Controller _roles = new Rol_Controller();
        public frm_lista_roles()
        {
            InitializeComponent();
        }

        private void frm_lista_roles_Load(object sender, EventArgs e)
        {
            cargar_lista();
        }

        public void cargar_lista()
        {
            lst_lista_roles.DataSource = _roles.todos();
            lst_lista_roles.ValueMember = "Id_Rol";
            lst_lista_roles.DisplayMember = "Nombre_Rol";
        }

        private void btn_agregar_Click(object sender, EventArgs e)
        {
            var frm_agregar = new frm_agregar_rol();
            frm_agregar.ShowDialog();
            cargar_lista();
            this.Close();
        }

        private void btn_salir_Click(object sender, EventArgs e)
        {
            this.Close();
        }

        private void btn_eliminar_Click(object sender, EventArgs e)
        {

            if (lst_lista_roles.SelectedIndex >= 0)
            {
                _roles.eliminar((int)lst_lista_roles.SelectedValue);
            }
            else
            {
                MessageBox.Show("Seleccione un rol para eliminar");
            }
            cargar_lista();
        }

        private void btn_editar_Click(object sender, EventArgs e)
        {
            if (lst_lista_roles.SelectedIndex == -1)
            {
                MessageBox.Show("Seleccione un usuario para editar");
            }
            else
            {
                int id_rol = (int)lst_lista_roles.SelectedValue;
                var editar_rol = new frm_editar_rol(id_rol);
                editar_rol.ShowDialog();
                this.Close();
            }
            cargar_lista();
        }
    }
}
